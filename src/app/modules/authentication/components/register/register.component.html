<div class="container one-column">
  <div class="content">
    <h1 class="label">Регистрация</h1>
    <p class="tagline">
      Введи свою почту, а также придумай имя пользователя и пароль. Если ты
      забудешь пароль, ты всегда сможешь восстановить его.
    </p>

    <form [formGroup]="form">
      <div>
        <app-usual-input [inputRequired]="true" [max]="20" type="text" id="username" formControlName="username"
          [placeholder]="'Имя пользователя'" required [error]="usernameNotValidError"></app-usual-input>
        <div class="error" *ngIf="form.get('username')?.hasError('usernameExists')">
          Это имя пользователя уже занято
        </div>
      </div>
      <div>
        <app-usual-input [inputRequired]="true" type="text" [max]="64" id="email" formControlName="email"
          [placeholder]="'Электронная почта'" required [error]="emailNotValidError"></app-usual-input>
        <div class="error" *ngIf="form.get('email')?.hasError('emailExists')">
          Пользователь с такой электронной почтой уже существует
        </div>
      </div>
      <app-usual-input [inputType]="'password'" [inputRequired]="true" id="password" formControlName="password"
        [placeholder]="'Пароль'" [max]="20" required [error]="passwordNotValidError"></app-usual-input>
    </form>


    <hr />

    <div class="buttons">
      <app-button [ngStyle]="{
          'pointer-events': form.valid ? 'all' : 'none'
        }" (click)="form.valid?modalAreYouSureShow = true:false" [disabled]="form.valid" [rounded]="true" [color]="'prim'"
        [text]="'Регистрация'"></app-button>
    </div>
  </div>
</div>

<app-modal @modal [style]="'prim'" *ngIf="modalAreYouSureShow" [title]="'Подтвердите регистрацию'" [type]="'yesOrNo'"
  (resultEmit)="handleAreYouSureModalResult($event)" [buttonsText]="['Да', 'Нет']" [description]="
    'Вы уверены, что хотите зарегистрироваться с введенными данными?'
  "></app-modal>


<app-modal [style]="'sec'" @modal *ngIf="modalSuccessShow" [title]="'Успешная регистрация!'" [type]="'Ok'"
  (resultEmit)="handleSuccessModalResult()" [buttonsText]="['На главную']" [description]="
    'Регистрация прошла успешно. Подтвердите электронную почту и после этого ваш аккаунт будет активирован!'
  "></app-modal>

<app-modal [style]="'prim'" @modal *ngIf="error" [title]="'Ошибка регистрации'" [type]="'Ok'"
  (resultEmit)="error=false;failText = ''" [buttonsText]="['Хорошо']" [description]="
    failText || 'Произошла неизвестная ошибка при попытке регистрации'
  "></app-modal>


<app-modal [noButtons]="true" [style]="'await'" *ngIf="loading" [title]="'Подождите...'" @modal
  [description]="'Проверяем данные, которые вы ввели... Подождите немного...'" />