<!-- eslint-disable @angular-eslint/template/interactive-supports-focus -->
<!-- eslint-disable @angular-eslint/template/click-events-have-key-events -->
<div class="background" (click)="clickBackgroundNotContent($event)">
  <div class="container">
    <button (click)="closeEmitter.emit(true)" class="close">
      <svg-icon
        class="close-svg"
        [applyClass]="true"
        [src]="'assets/images/svg/close.svg'"
      ></svg-icon>
    </button>

    <div class="zero">
      <section class="main-wrap">
        <nav class="nav noselect">
          <h1>Настройки</h1>
          <hr>
          <div class="switches">
            <button 
            class="switch"
            [ngClass]="{'selected':step===i}" 
            (click)="step=i"
            *ngFor="let item of steps; let i = index">
              {{item}}
            </button>
          </div>
        </nav>
        <div class="content">
          <div *ngIf="step === 1">
            <h2>Персональная информация</h2>
            <div class="blocks">
              <div>
                <h3>
                  <svg-icon [applyClass]="true" class="icon" [src]="'assets/images/svg/settings/mail.svg'"/>
                  Электронная почта</h3>
                <p>{{ user.email }}</p>
              </div>
              <div>
                <h3>
                                    <svg-icon [applyClass]="true" class="icon" [src]="'assets/images/svg/settings/username.svg'"/>

                  Имя пользователя</h3>
                <p>{{"@" + user.username }}</p>
              </div>
              <button class="action disabled">Поменять пароль</button>
              <button class="action red" (click)="deleteModalShow = true">
                Удалить аккаунт
              </button>
            </div>
          </div>
          <div *ngIf="step === 2">
            <h2>Уведомления</h2>
            <div class="blocks third">
              <div *ngFor="let section of permissionNotificationSections">
                <h3>
                  <svg-icon [applyClass]="true" class="icon" [src]="'assets/images/svg/settings/'+section.icon+'.svg'"/>
                  {{ section.title }}</h3>
                <div>
                  <div class="toogle" *ngFor="let item of section.items">
                    <p>{{ item.description }}</p>
                    <app-toogle-switch
                      [checked]="userPermissionEnabled(item.area)"
                      (checkedEmit)="tooglePermission(item.area,!userPermissionEnabled(item.area))"></app-toogle-switch>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="step === 0">
            <h2>Основное</h2>
            <div class="blocks">
              <div class="toogle">
                <p class="not-link">Темная тема</p>
                <app-toogle-switch
                  [backgroundOff]="'var(--color-secondary)'"
                  [backgroundOn]="'var(--color-foreground)'"
                  [toogleOff]="'var(--color-background)'"
                  [toogleOn]="'var(--color-secondary)'"
                  (checkedEmit)="nightModeEmit($event)"
                  [nightMode]="true"
                ></app-toogle-switch>
              </div>
              <div>
                <p class="disabled"><a routerLink="/about">О сайте...</a></p>
                <p class="disabled"><a routerLink="/user-policy">Пользовательское соглашение...</a></p>
              </div>
              <div>
                <p>Пригласите друзей</p>
                <div class="socials">
                  <app-social-button [url]="location"></app-social-button>
                  <app-social-button [url]="location" [social]="social" *ngFor="let social of socials"></app-social-button>
                </div>
              </div>
              <button class="action red" (click)="exitModalShow = true">
                Выйти из аккаунта
              </button>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>

  <app-modal
    @modal
    *ngIf="exitModalShow"
    [style]="'prim'"
    [title]="'Подтвердите выход'"
    [type]="'yesOrNo'"
    (resultEmit)="handleExitModal($event)"
    [buttonsText]="['Выйти', 'Остаться']"
    [description]="'Вы действительно хотите выйти из текущего аккаунта?'"
  ></app-modal>

  <app-modal
    @modal
    *ngIf="deleteModalShow"
    [style]="'prim'"
    [title]="'Подтвердите удаление'"
    [type]="'yesOrNo'"
    (resultEmit)="handleDeleteModal($event)"
    [buttonsText]="['Удалить', 'Не удалять']"
    [description]="
      'Вы действительно хотите удалить свой аккаунт? Это действие нельзя будет отменить!'
    "
  ></app-modal>
</div>
