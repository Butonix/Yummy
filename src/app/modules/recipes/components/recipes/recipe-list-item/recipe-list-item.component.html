<!-- eslint-disable @angular-eslint/template/interactive-supports-focus -->
<!-- eslint-disable @angular-eslint/template/click-events-have-key-events -->

<ng-template #sceleton>
  <div class="recipe sceleton null">
    <p>
      Здесь могла быть <br />
      ваша реклама
    </p>
    <svg-icon [applyClass]="true" class="no-recipe-svg"
      [src]="'../../../../../assets/images/svg/no-recipe.svg'"></svg-icon>
  </div>
</ng-template>
<div *ngIf="dataLoaded && recipe.id > 0; else sceleton" class="recipe" [title]="recipe.name">
  <div class="top">
    <div></div>
    <div [ngClass]="{'disabled':recipe.status==='awaits'}" *ngIf="recipe.authorId === currentUserId || recipe.status === 'public'"
      (click)="recipe.status === 'public' ? makeThisRecipeFavorite() : editMode=true" class="fav">
      <svg-icon *ngIf="recipe.status !== 'public'" [src]="'../../../../../assets/images/svg/pen.svg'"
        [applyClass]="true" class="fav-icon"></svg-icon>
      <svg-icon *ngIf="recipe.status === 'public' && !isRecipeFavorite"
        [src]="'../../../../../assets/images/svg/fav.svg'" [applyClass]="true" class="fav-icon"></svg-icon>
      <svg-icon *ngIf="recipe.status === 'public' && isRecipeFavorite"
        [src]="'../../../../../assets/images/svg/fav-fill.svg'" [applyClass]="true" class="fav-icon"></svg-icon>
    </div>
  </div>
  <div class="bottom">
    <div class="title" [ngClass]="{ 'no-author': !showAuthor }">
      <h1 [routerLink]="'/recipes/list/' + recipe.id">{{ recipe.name }}</h1>
    </div>
    <div *ngIf="showAuthor" [routerLink]="'/cooks/list/' + author.id" class="author">
      {{ author.fullName===''?('@'+author.username):author.fullName }}
    </div>

    <div class="rate-panel" *ngIf="recipe.status === 'public'">
      <div class="rate-item likes" (click)="likeThisRecipe()">
        <svg-icon *ngIf="!isRecipeLiked" [src]="'../../../../../assets/images/svg/like.svg'" [applyClass]="true"
          class="like-icon"></svg-icon>
        <svg-icon *ngIf="isRecipeLiked" [src]="'../../../../../assets/images/svg/like-fill.svg'" [applyClass]="true"
          class="like-icon liked"></svg-icon>
        <span [ngClass]="{ liked: isRecipeLiked }">{{
          recipe.likesId.length
          }}</span>
      </div>
      <div class="rate-item cooks" (click)="cookThisRecipe()">
        <svg-icon *ngIf="!isRecipeCooked" [src]="'../../../../../assets/images/svg/cook.svg'" [applyClass]="true"
          class="cook-icon"></svg-icon>
        <svg-icon *ngIf="isRecipeCooked" [src]="'../../../../../assets/images/svg/cook-fill.svg'" [applyClass]="true"
          class="cook-icon cooked"></svg-icon>
        <span [ngClass]="{ cooked: isRecipeCooked }">{{
          recipe.cooksId.length
          }}</span>
      </div>
    </div>
    <div class="rate-panel" *ngIf="!(recipe.status === 'public')">
      <div class="rate-item likes" style="cursor: default">
        <svg-icon [src]="
            '../../../../../assets/images/svg/' +
            (recipe.status === 'awaits' ? 'awaits' : 'private') +
            '.svg'
          " [applyClass]="true" class="like-icon"></svg-icon>
        <span>{{
          recipe.status === "private" ? "Не опубликован" : "Ожидает проверки"
          }}</span>
      </div>
    </div>
  </div>

  
</div>

<app-modal @modal *ngIf="noAccessModalShow" [style]="'prim'" [title]="'Доступ к функции ограничен'" [type]="'yesOrNo'"
  (resultEmit)="handleNoAccessModal($event)" [buttonsText]="['Давайте', 'Не сейчас']" [description]="
    'Взаимодействовать с рецептами могут только пользователи с личным аккаунтом. Хотите зарегистрироваться или войти в существующий аккаунт?'
  "></app-modal>

    <app-recipe-creating style="z-index:10; position: fixed;" [editedRecipe]="recipe" *ngIf="editMode" (closeEmitter)="editModeOff()" @modal ></app-recipe-creating>